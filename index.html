<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××’×–×™×Ÿ ×¢×ª×™×“ ×©××™×¨ | Digital Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css"> 
</head>
<body>
<header>
    <img src="logo.png" alt="×œ×•×’×• ×¢×ª×™×“ ×©××™×¨" class="main-logo" />
</header>

<div class="filter-container">
    <button class="filter-btn active" onclick="filterBy('all')">×”×›×œ</button>
    <select class="dropdown-select" onchange="filterBy(this.value)">
        <option value="all">×‘×—×¨ ×—×•×“×©...</option>
        <option value="×™× ×•××¨">×™× ×•××¨</option><option value="×¤×‘×¨×•××¨">×¤×‘×¨×•××¨</option>
        <option value="××¨×¥">××¨×¥</option><option value="××¤×¨×™×œ">××¤×¨×™×œ</option>
        <option value="×××™">×××™</option><option value="×™×•× ×™">×™×•× ×™</option>
        <option value="×™×•×œ×™">×™×•×œ×™</option><option value="××•×’×•×¡×˜">××•×’×•×¡×˜</option>
        <option value="×¡×¤×˜××‘×¨">×¡×¤×˜××‘×¨</option><option value="××•×§×˜×•×‘×¨">××•×§×˜×•×‘×¨</option>
        <option value="× ×•×‘××‘×¨">× ×•×‘××‘×¨</option><option value="×“×¦××‘×¨">×“×¦××‘×¨</option>
    </select>
    <button class="filter-btn" onclick="filterBy('××’××•×ª')">××’××•×ª</button>
    <button class="filter-btn" onclick="filterBy('×”× ×”×œ×”')">×”× ×”×œ×”</button>
    <button class="filter-btn" onclick="filterBy('×¦×•×•×ª')">×¦×•×•×ª</button>
    <button class="filter-btn" onclick="filterBy('PBL')">PBL</button>
    <button class="filter-btn" onclick="filterBy('×œ×™××•×“×™×')">×œ×™××•×“×™×</button>
    <button class="filter-btn" onclick="filterBy('×¡×™×•×¨×™× ×•×˜×™×•×œ×™×')">×¡×™×•×¨×™× ×•×˜×™×•×œ×™×</button>
    <button class="filter-btn" onclick="filterBy('×¤×¢×™×œ×•×™×•×ª')">×¤×¢×™×œ×•×™×•×ª</button>
    <button class="filter-btn" onclick="filterBy('×”×¨×¦××•×ª ×•×˜×§×¡×™×')">×”×¨×¦××•×ª ×•×˜×§×¡×™×</button>
    <button class="filter-btn" onclick="filterBy('×¡×™×›×•× ××—×¦×™×ª ×')">×¡×™×›×•× ××—×¦×™×ª ×'</button>
    <button class="sort-btn" id="sortBtn" onclick="toggleSort()">××™×•×Ÿ: ××”×—×“×© ×œ×™×©×Ÿ</button>
</div>

<div class="main-layout">
    <div id="main-grid" class="grid"></div>
    <div class="sidebar">
        <div class="widget">
            <h3>×”×¨×©××” ×œ×¢×“×›×•× ×™× âœ‰ï¸</h3>
            <form action="https://formspree.io/f/xvzbpddl" method="POST" id="subForm">
                <input type="email" name="email" id="emailInput" placeholder="×”××™××™×™×œ ×©×œ×š..." required>
                <button type="submit" style="width:100%; padding:10px; background:var(--secondary); color:white; border:none; border-radius:10px; cursor:pointer; font-weight:bold;">×”×¨×©××”</button>
            </form>
            <p id="subMsg" style="font-size: 0.8rem; color: green; margin-top: 10px; display: none;">× ×¨×©××ª ×‘×”×¦×œ×—×”! ğŸ‰</p>
        </div>
        
        <div class="widget">
            <h3>×¡×¤×™×¨×” ×œ××—×•×¨ â³</h3>
            <p>×™××™× ×œ×—×•×¤×©×ª ×¤×•×¨×™× 2026:</p>
            <div id="countdown" style="font-size: 2.5rem; font-weight: bold; color: var(--primary);">--</div>
        </div>

        <div class="widget manager-widget">
            <h3>×“×‘×¨ ×”×× ×”×œ×ª âœ‰ï¸</h3>
            <p style="font-style: italic;">"×’××” ×‘×›× ×¢×œ ××—×¦×™×ª ×©×œ ×¢×©×™×™×” ×•×˜×›× ×•×œ×•×’×™×”. ××ª× ×“×•×¨ ×”×¢×ª×™×“ ×©××¦×¢×™×“ ××ª ×‘×™×ª ×”×¡×¤×¨ ×œ×”×™×©×’×™× ×—×¡×¨×™ ×ª×§×“×™×."</p>
            <div style="text-align: left; font-weight: bold;">- ××™×¨×‘ ×©×œ×•×</div>
        </div>
    </div>
</div>

<div id="articleModal" class="modal" onclick="if(event.target === this) closeModal()">
    <div class="modal-content">
        <span onclick="closeModal()" style="position:absolute; left:20px; top:20px; font-size:35px; cursor:pointer; z-index:100; color: #888;">&times;</span>
        <div id="m-content"></div>
    </div>
</div>

<footer>
    <div class="footer-content">
        <p style="font-size: 1.2rem; font-weight: 700;">×¢×ª×™×“ ×™×¦×—×§ ×©××™×¨ - ×¨××œ×”</p>
        <p class="footer-credits">×”××’×–×™×Ÿ ×”×“×™×’×™×˜×œ×™ | × ×¢×¨×š ×•×¢×•×¦×‘ ×¢"×™ <span class="footer-name">×©××¢×•×Ÿ ×—×™×™××•×‘</span> &copy; 2026</p>
    </div>
</footer>

<script src="articles.js"></script>

<script>
    let currentFilter = 'all';
    let isDescending = true;
    let modalMediaList = [];
    let currentModalIndex = 0;

    window.onload = () => {
        renderArticles();
        updateCountdown();
        
        const hash = window.location.hash;
        if (hash && hash.startsWith('#article-')) {
            const index = parseInt(hash.split('-')[1]);
            if (!isNaN(index) && articles[index]) {
                setTimeout(() => openModal(articles[index]), 500);
            }
        }
    };

    function getMediaList(art) {
        let list = [];
        if (art.media) list = [...art.media];
        else if (art.images) list = [...art.images];
        else if (art.img) list = [art.img];
        if (art.youtube) list.push(`yt:${art.youtube}`);
        return list;
    }

    function renderMediaItem(item, isModal = false) {
        const className = isModal ? 'modal-media-item' : 'card-img';
        if (!item) return '';

        let finalPath = item;
        if (!item.startsWith('http') && !item.startsWith('yt:') && !item.startsWith('assets/')) {
            finalPath = `assets/${item}`;
        }

        if (item.startsWith('yt:')) {
            let videoId = item.replace('yt:', '');
            return `<iframe src="https://www.youtube.com/embed/${videoId}" class="${className}" style="border:none;" allowfullscreen></iframe>`;
        }
        if (item.toLowerCase().endsWith('.mp4')) {
            return `<video src="${finalPath}" class="${className}" controls ${!isModal ? 'muted autoplay loop' : ''} preload="none"></video>`;
        }
        // Lazy Loading ××™×•×©× ×›××Ÿ
        return `<img src="${finalPath}" class="${className}" loading="lazy" onerror="this.src='https://via.placeholder.com/400x250?text=×ª××•× ×”+×—×¡×¨×”'">`;
    }

    function renderArticles() {
        const grid = document.getElementById('main-grid');
        grid.innerHTML = '';
        let filtered = currentFilter === 'all' ? [...articles] : articles.filter(a => a.month === currentFilter || a.tag === currentFilter);
        
        filtered.sort((a, b) => {
            const dateA = new Date(a.date.split('.').reverse().join('-'));
            const dateB = new Date(b.date.split('.').reverse().join('-'));
            return isDescending ? dateB - dateA : dateA - dateB;
        });

        filtered.forEach((art) => {
            const mediaList = getMediaList(art);
            const artIndexInArray = articles.indexOf(art); 
            const el = document.createElement('div');
            el.className = 'card';
            el.innerHTML = `
                <div class="card-img-wrapper" onclick="openModal(articles[${artIndexInArray}])">
                    <div class="month-badge">${art.month}</div>
                    ${mediaList.length > 1 ? `
                        <button class="nav-btn prev-btn" onclick="event.stopPropagation(); changeMedia(${artIndexInArray}, 1, this)">â¯</button>
                        <button class="nav-btn next-btn" onclick="event.stopPropagation(); changeMedia(${artIndexInArray}, -1, this)">â®</button>
                        <div class="dots-container" id="dots-${artIndexInArray}">
                            ${mediaList.map((_, i) => `<div class="dot ${i===0?'active':''}" id="dot-${artIndexInArray}-${i}"></div>`).join('')}
                        </div>
                    ` : ''}
                    <div id="media-holder-${artIndexInArray}" style="width:100%; height:100%;">
                        ${renderMediaItem(mediaList[0])}
                    </div>
                </div>
                <div class="card-body" onclick="openModal(articles[${artIndexInArray}])">
                    <span style="color:var(--primary); font-size:0.85rem; font-weight:bold;">#${art.tag}</span>
                    <h3>${art.title}</h3>
                    <p>${art.text.substring(0,85)}...</p>
                </div>
            `;
            grid.appendChild(el);
        });
    }

    function openModal(art) {
        modalMediaList = getMediaList(art);
        currentModalIndex = 0;
        const artIndex = articles.indexOf(art);
        const content = document.getElementById('m-content');
        
        content.innerHTML = `
            <div class="modal-header-area" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; padding-left: 50px; padding-top: 10px;">
                <h2 style="margin:0; color:var(--dark); font-size:2rem; line-height: 1.2;">${art.title}</h2>
                <div style="display: flex; align-items: center; gap: 10px; flex-shrink: 0;">
                    <span id="share-feedback">×”×•×¢×ª×§!</span>
                    <button class="share-btn-framed" onclick="shareArticle(${artIndex})">
                        <span>×©×ª×£ ×›×ª×‘×”</span>
                        <span>ğŸ”—</span>
                    </button>
                </div>
            </div>

            <div class="meta-info">
                <span>âœï¸ ×××ª: ${art.author}</span>
                <span>ğŸ“… ×ª××¨×™×š: ${art.date}</span>
                <span>ğŸ·ï¸ ×§×˜×’×•×¨×™×”: ${art.tag}</span>
            </div>

            <div class="modal-media-wrapper">
                ${modalMediaList.length > 1 ? `
                    <button class="nav-btn prev-btn" onclick="changeModalMedia(1)">â¯</button>
                    <button class="nav-btn next-btn" onclick="changeModalMedia(-1)">â®</button>
                    <div class="dots-container">
                        ${modalMediaList.map((_, i) => `<div class="dot ${i===0?'active':''}" id="mdot-${i}"></div>`).join('')}
                    </div>
                ` : ''}
                <div id="modal-media-holder" style="width:100%; height:100%;">
                    ${renderMediaItem(modalMediaList[0], true)}
                </div>
            </div>

            <div class="article-body">${art.text}</div>
        `;
        
        window.history.pushState(null, null, `#article-${artIndex}`);
        document.getElementById('articleModal').style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }

    function shareArticle(index) {
        const url = window.location.origin + window.location.pathname + "#article-" + index;
        navigator.clipboard.writeText(url).then(() => {
            const fb = document.getElementById('share-feedback');
            fb.style.display = 'inline';
            setTimeout(() => fb.style.display = 'none', 2000);
        });
        if (navigator.share) {
            navigator.share({ title: articles[index].title, url: url }).catch(()=>{});
        }
    }

    // ×©××¨ ×”×¤×•× ×§×¦×™×•×ª (changeMedia, changeModalMedia, closeModal, filterBy, toggleSort, updateCountdown)
    // × ×©××¨×•×ª ×›×¤×™ ×©×”×™×• ×‘×’×¨×¡××•×ª ×”×§×•×“××•×ª
    function changeMedia(artIndex, direction, btnEl) {
        const art = articles[artIndex];
        const mediaList = getMediaList(art);
        const holder = document.getElementById(`media-holder-${artIndex}`);
        let currentIndex = parseInt(holder.getAttribute('data-index') || 0);
        currentIndex += direction;
        if (currentIndex >= mediaList.length) currentIndex = 0;
        if (currentIndex < 0) currentIndex = mediaList.length - 1;
        holder.setAttribute('data-index', currentIndex);
        holder.innerHTML = renderMediaItem(mediaList[currentIndex]);
        document.querySelectorAll(`#dots-${artIndex} .dot`).forEach((dot, i) => {
            dot.classList.toggle('active', i === currentIndex);
        });
    }

    function changeModalMedia(direction) {
        currentModalIndex += direction;
        if (currentModalIndex >= modalMediaList.length) currentModalIndex = 0;
        if (currentModalIndex < 0) currentModalIndex = modalMediaList.length - 1;
        document.getElementById('modal-media-holder').innerHTML = renderMediaItem(modalMediaList[currentModalIndex], true);
        document.querySelectorAll('.modal-media-wrapper .dot').forEach((dot, i) => dot.classList.toggle('active', i === currentModalIndex));
    }

    function closeModal() {
        document.getElementById('articleModal').style.display = 'none';
        document.body.style.overflow = 'auto';
        window.history.pushState(null, null, window.location.pathname);
    }

    function filterBy(val) {
        currentFilter = val;
        renderArticles();
    }

    function toggleSort() {
        isDescending = !isDescending;
        document.getElementById('sortBtn').innerText = isDescending ? "××™×•×Ÿ: ××”×—×“×© ×œ×™×©×Ÿ" : "××™×•×Ÿ: ××”×™×©×Ÿ ×œ×—×“×©";
        renderArticles();
    }

    function updateCountdown() {
        const target = new Date('March 3, 2026').getTime();
        const now = new Date().getTime();
        const diff = target - now;
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        document.getElementById('countdown').innerText = days > 0 ? days : "×—×•×¤×©×” × ×¢×™××”!";
    }
</script>
</body>
</html>